//引入mysql模块
var mysql = require("mysql");
//链接数据库的参数
var config = {
	host:"127.0.0.1",
	port:3306,
	user:"root",
	password:"root",
	database:"hejyproject"
};
//创建连接池
var pool = mysql.createPool(config);
var dbUtil = {
	//处理函数
	handler:function(sql,param,fn){
		pool.getConnection(function(err,connection){
			if(!err){
				connection.query(sql,param,function(err,results){
					if(!err){
						fn.call(this,results);
						//释放链接
						connection.release();
					}else{
						console.log("数据库操作出错",err);
					}
				});
			}else{
				console.log("数据库链接出错",err);
			}
		});

	},
	excute:function(sql,param,fn){
		this.handler(sql,param,fn);
	}
};
module.exports = dbUtil;
